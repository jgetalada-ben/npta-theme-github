{% comment %}
  Section: Trending Feature Row
  - Up to 4 feature cards
  - Desktop: inline grid
  - Mobile: slider/carousel with arrows (no autoplay)
{% endcomment %}

<section
  id="TrendingRow-{{ section.id }}"
  class="trending-row"
  style="
    --pt: {{ section.settings.pad_top | default: 48 }}px;
    --pr: {{ section.settings.pad_right | default: 24 }}px;
    --pb: {{ section.settings.pad_bottom | default: 48 }}px;
    --pl: {{ section.settings.pad_left | default: 24 }}px;
    --gap: {{ section.settings.gap | default: 32 }}px;
    --bg: {{ section.settings.bg | default: '#ffffff' }};
    --tr-card-bg: {{ section.settings.card_bg | default: '#ffffff' }};
    --tr-eyebrow-size: {{ section.settings.eyebrow_size | default: '11px' }};
    --tr-card-title-size: {{ section.settings.card_title_size | default: 'clamp(16px,1.5vw,20px)' }};
    --tr-button-size: {{ section.settings.button_font_size | default: '12px' }};
  "
>
  {%- assign mw = section.settings.max_width | default: '1200px' | strip -%}
  {%- unless mw contains 'px' or mw contains '%' or mw contains 'vw' or mw contains 'rem' -%}
    {%- assign mw = mw | append: 'px' -%}
  {%- endunless -%}

  {%- liquid
    assign show_mobile_slider = false
    if section.blocks.size > 1
      assign show_mobile_slider = true
    endif
  -%}

  <div class="trending-row__inner" style="max-width: {{ mw }};">
    {% if section.settings.heading != blank or section.settings.subheading != blank %}
      <div class="trending-row__header">
        {% if section.settings.heading != blank %}
          <h2 class="trending-row__title">
            {{ section.settings.heading }}
          </h2>
        {% endif %}
        {% if section.settings.subheading != blank %}
          <p class="trending-row__subheading">
            {{ section.settings.subheading }}
          </p>
        {% endif %}
      </div>
    {% endif %}

    <slider-component class="trending-row__slider slider-mobile-gutter">
      <ul
        id="TrendingSlider-{{ section.id }}"
        class="trending-row__list grid grid--1-col-tablet-down grid--{{ section.settings.columns_desktop }}-col-desktop{% if show_mobile_slider %} slider slider--tablet grid--peek{% endif %}"
        role="list"
      >
        {% for block in section.blocks %}
          <li
            id="TrendingSlide-{{ section.id }}-{{ forloop.index }}"
            class="trending-row__item grid__item{% if show_mobile_slider %} slider__slide{% endif %}"
            {{ block.shopify_attributes }}
          >
            <div class="trending-card">
              {% if block.settings.image != blank %}
                <div class="trending-card__image-wrapper">
                  {{
                    block.settings.image
                    | image_url: width: 1200
                    | image_tag:
                      loading: 'lazy',
                      class: 'trending-card__image',
                      widths: '300, 450, 600, 900, 1200',
                      sizes: '(min-width: 990px) 25vw, 80vw'
                  }}
                </div>
              {% endif %}

              <div class="trending-card__info">
                {% if block.settings.eyebrow != blank %}
                  <p class="trending-card__eyebrow">
                    {{ block.settings.eyebrow }}
                  </p>
                {% endif %}

                {% if block.settings.title != blank %}
                  <h3 class="trending-card__title">
                    {{ block.settings.title }}
                  </h3>
                {% endif %}

                {% if block.settings.button_label != blank %}
                  <a
                    class="trending-card__link"
                    {% if block.settings.button_link == blank %}
                      role="link" aria-disabled="true"
                    {% else %}
                      href="{{ block.settings.button_link }}"
                    {% endif %}
                  >
                    {{ block.settings.button_label }}
                  </a>
                {% endif %}
              </div>
            </div>
          </li>
        {% endfor %}
      </ul>

      {% if show_mobile_slider %}
        <div class="slider-buttons large-up-hide">
          <button
            type="button"
            class="slider-button slider-button--prev"
            name="previous"
            aria-label="{{ 'general.slider.previous_slide' | t }}"
          >
            {% render 'icon-caret' %}
          </button>
          <div class="slider-counter caption">
            <span class="slider-counter--current">1</span>
            <span aria-hidden="true"> / </span>
            <span class="visually-hidden">{{ 'general.slider.of' | t }}</span>
            <span class="slider-counter--total">{{ section.blocks.size }}</span>
          </div>
          <button
            type="button"
            class="slider-button slider-button--next"
            name="next"
            aria-label="{{ 'general.slider.next_slide' | t }}"
          >
            {% render 'icon-caret' %}
          </button>
        </div>
      {% endif %}
    </slider-component>
  </div>

  {% stylesheet %}
  .trending-row {
    background: var(--bg);
    padding: var(--pt) var(--pr) var(--pb) var(--pl);
  }
  .trending-row__inner {
    margin: 0 auto;
    width: 100%;
  }

  /* Optional header (if you use it) */
  .trending-row__header {
    text-align: center;
    margin-bottom: 32px;
  }
  .trending-row__title {
    margin: 0 0 8px;
    font-family: var(--font-anton);
    font-weight: 400;
    font-size: clamp(24px, 3vw, 36px);
    letter-spacing: 0.04em;
    text-transform: uppercase;
    color: #01241E;
  }
  .trending-row__subheading {
    margin: 0;
    font-family: var(--font-poppins400);
    font-size: clamp(14px, 1.4vw, 18px);
    color: #01241E;
    opacity: 0.85;
  }

  .trending-row__list {
    gap: var(--gap);
  }

  /* ------- CARD LAYOUT ------- */
  /* Card is just a column wrapper now */
  .trending-card {
    display: flex;
    flex-direction: column;
    align-items: end;
    background: transparent;
    border-radius: 0;
    box-shadow: none;
  }

  /* Image: no radius, no clipping, more of the head visible */
  .trending-card__image-wrapper {
    width: 100%;
    overflow: visible;
  }
  .trending-card__image {
    width: 100%;
    height: auto;
    display: block;
    aspect-ratio: 16 / 11;
    object-fit: cover;
    object-position: center top; /* keeps the top of the image in frame */
    border-radius: 0;            /* âœ… no rounded corners on the image */
    transition: transform 0.35s ease;
  }

  /* White content box under the image (like the design) */
  .trending-card__info {
    position: relative;
    background: var(--tr-card-bg);
    border-radius: 0;
    padding: 22px 40px 26px;
    text-align: right;
    width: min(520px, 78%);
    margin-top: -48px;
    z-index: 1;
  }

  /* Typography inside content box */
  .trending-card__eyebrow {
    margin: 0 0 6px;
    font-family: var(--font-poppins700);
    font-size: var(--tr-eyebrow-size);
    letter-spacing: 0.16em;
    text-transform: uppercase;
    color: #777;
  }

  .trending-card__title {
    margin: 0 0 14px;
    font-family: var(--font-poppins700);
    font-size: var(--tr-card-title-size);
    line-height: 1.4;
    text-transform: uppercase;
    color: #000;
  }
  .trending-card__link {
    display: inline-block;
    font-family: var(--font-adirek800);
    font-size: var(--tr-button-size);
    letter-spacing: 0.18em;
    text-transform: uppercase;
    text-decoration: none;
    color: #000;
    position: relative;
    padding-bottom: 2px;
  }
  .trending-card__link::after {
    content: "";
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 1px;
    background: #000;
    transition: transform 0.25s ease;
    transform-origin: left;
    transform: scaleX(0);
  }
  .trending-card__link:hover::after {
    transform: scaleX(1);
  }

  /* Mobile: make each slide nicely sized */
  @media screen and (max-width: 749px) {
    .trending-row__list {
      grid-auto-columns: minmax(80%, 1fr);
    }

    .trending-card__info {
      width: 86%;
      margin-top: -36px;
      padding: 20px 24px 22px;
    }
  }
  {% endstylesheet %}

</section>

{% schema %}
{
  "name": "Trending feature row",
  "tag": "section",
  "class": "section trending-feature-row",
  "max_blocks": 4,
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Now trending"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Discover our most popular certifications"
    },
    {
      "type": "text",
      "id": "max_width",
      "label": "Max width (e.g. 1200px or 90%)",
      "default": "1200px"
    },
    {
      "type": "color",
      "id": "bg",
      "label": "Section background",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "label": "Cards per row (desktop)",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 2
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "pad_top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 48
    },
    {
      "type": "range",
      "id": "pad_right",
      "min": 0,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Padding right",
      "default": 24
    },
    {
      "type": "range",
      "id": "pad_bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 48
    },
    {
      "type": "range",
      "id": "pad_left",
      "min": 0,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Padding left",
      "default": 24
    },
    {
      "type": "range",
      "id": "gap",
      "min": 8,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Card gap",
      "default": 32
    },
        {
      "type": "header",
      "content": "Card styles"
    },
    {
      "type": "color",
      "id": "card_bg",
      "label": "Card background color",
      "default": "#FFFFFF"
    },
    {
      "type": "text",
      "id": "eyebrow_size",
      "label": "Eyebrow font-size (accepts clamp())",
      "default": "11px"
    },
    {
      "type": "text",
      "id": "card_title_size",
      "label": "Card title font-size (accepts clamp())",
      "default": "clamp(16px,1.5vw,20px)"
    },
    {
      "type": "text",
      "id": "button_font_size",
      "label": "Button font-size (accepts clamp())",
      "default": "12px"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "eyebrow",
          "label": "Eyebrow",
          "default": "Now trending"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Become a certified personal trainer"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "default": "Shop now"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Trending feature row",
      "blocks": [
        { "type": "card" },
        { "type": "card" }
      ]
    }
  ]
}
{% endschema %}
